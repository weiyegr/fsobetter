function fullpagefooterinit(){$(".fullpage_alllist").each(function(){if($('.full_column:not([deleted="deleted"])').length>0){wp_alert(translate("full_column.already in backplane"))}});$(".full_pagescroll").each(function(){fullpagescrollinit($(this))});$(document).bind("fullpage_scroll_pro",function(A,B){setTimeout(function(){if($("#wp-property_settings2").length){var C="";$("#canvas #fullPage-nav li").each(function(D){});$(".fullpage_alllist .section").each(function(D){if($(this).hasClass("active")){C=D+1}});if(C>0){$("#all_extra_img_div .wp-manage-panel-album-img").each(function(D){var E=D+1;if(E==C){$(this).addClass("action")}else{$(this).removeClass("action")}})}}},100)})}function fullpagescrollinit(A){A.children(".full_width").css({left:0-canv.offset().left-$.parseInteger($("#canvas").css("borderLeftWidth")),width:$("#scroll_container_bg").width()});A.wp_rightkey();if(A.is(":not(.isplate)")){fullpagescrollresize(A);setTimeout(function(){fullpagescrolldrop(A)},1300)}}function fullpagescrolldrag(A){A.wp_drag()}function fullpagescrollresize(A){var B=function(E){A.each(function(){var F="ui-resizable-"+E;var G=$('<div class="ui-resizable-handle '+F+'"><p class="knob "></p></div>');G.css({zIndex:1000});$(this).children(".full_width").append(G)})};var C=function(E){A.each(function(){var F="placeholder-"+E;var G=$('<div class="li-placeholder  '+F+'"></div>');G.css({zIndex:1000}).hide();$(this).children(".full_width").append(G)})};B("n");B("s");C("w");C("e");var D;A.resizable({handles:{n:">.full_width .ui-resizable-n",s:">.full_width .ui-resizable-s"},noinit:true,canvascontain:"#canvas",distance:0,concernLock:true,scroll:true,create:function(){$(this).children(".full_width").find(".ui-resizable-handle").hide()},start:function(I,E){D=$.getFullColChildMaxButtomfullpage(A);var G=$(this);var H=new ResizeCommand(G.attr("id"));var K=["top","height"];var J={};for(var F=0;F<K.length;F++){J[K[F]]=G.css(K[F])}H.setOldVal(J);$(document).data("resizeundo",H)},resize:function(H,E){var I=A.ab_pos_cnter("top");var G=$.parseInteger(A.css("height"));if($.getElementAreaInf($(this))=="canvas"){var F=Math.max(I+D,I+G);$.canvasheightresizeOrigin(F)}$(this).children(".full_content,.full_width").height($(this).height());$(this).triggerHandler("resize_progress",[{ui:E}]);$.fullpageshowselectbgopt($(this))},stop:function(I,E){$(this).children(".full_content,.full_width").height($(this).height());$.fullpageshowselectbgopt($(this));var H=$(document).data("resizeundo");$(document).removeData("resizeundo");var G=$(this);var K=["top","height"];var J={};for(var F=0;F<K.length;F++){J[K[F]]=G.css(K[F])}$(this).triggerHandler("resize_stop",[{ui:E}]);H.insertWithNewVal(J)}})}function fullpagescrolldrop(A){if($.wismobile!=1){A.css({"border":"dashed #AF6935 2px"})}var C=function(D){A.each(function(){var E="placeholder-"+D;var F=$('<div class="li-placeholder  '+E+'"></div>');F.css({zIndex:1000});$(this).children(".full_content").append(F)})};C("n");C("s");C("w");C("e");var B=A.children(".full_content");B.children(".li-placeholder").hide();B.children(".placeholder-n").css({"border-top":"#FF9900 dashed 4px"});B.children(".placeholder-s").css({"border-bottom":"#FF9900 dashed 4px"});B.children(".placeholder-e").css({"border-right":"#FF9900 dashed 4px"});B.children(".placeholder-w").css({"border-left":"#FF9900 dashed 4px"});B.droppable({tolerance:"pointer",accept:".full_pagescroll,.cstlayer,.wp-new-tool-second-link,.wp-manage-plugin-block",drop:function(G,D){var E=$.ui.ddmanager.current;if($.getElementAreaInf($(E.element))==$.getElementAreaInf(A)){if(!A.hasClass("ui-modselected")||$(E.element).is(".wp-new-tool-second-link")||$(E.element).is(".wp-manage-plugin-block")){$(this).children(".li-placeholder").hide();var H=$(document).data("layer_final_drop_id");var F=$.chooseBiggerColumn(H,A.attr("id"));$(document).data("layer_final_drop_id",F)}}},over:function(J,N){var H=false;$(".ui-modselected").each(function(){if($(this).data("cstlayerstatus")=="unlock"){H=true}});if(H){return}var I=$.ui.ddmanager.current;if($.getElementAreaInf($(I.element))==$.getElementAreaInf(A)||$(I.element).is(".wp-new-tool-second-link")||$(I.element).is(".wp-manage-plugin-block")){if(!A.hasClass("ui-modselected")||$(I.element).is(".wp-new-tool-second-link")||$(I.element).is(".wp-manage-plugin-block")){var D=A.attr("id");var F=$(document).data("layer_drop_over_id");if(D!=F){var K=$.chooseBiggerColumn(F,D);if(K==D){var M=$(this);$(this).children(".li-placeholder").show();if(F){var G=$("#"+F);var E=G.children(".full_content").data("droppable");E["isover"]=0;E["isout"]=1;E._out.call(E,J)}$(document).data("layer_drop_over_id",D)}else{var L=$(this).data("droppable");L["isover"]=0;L["isout"]=1}}}}},out:function(G,D){var H=false;$(".ui-modselected").each(function(){if($(this).data("cstlayerstatus")=="unlock"){H=true}});if(H){return}var E=$.ui.ddmanager.current;if($.getElementAreaInf($(E.element))==$.getElementAreaInf(A)){if(!A.hasClass("ui-modselected")||$(E.element).is(".wp-new-tool-second-link")||$(E.element).is(".wp-manage-plugin-block")){$(this).children(".li-placeholder").hide();var F=$(document).data("layer_drop_over_id");if(F==A.attr("id")){$(document).removeData("layer_drop_over_id")}}}}})}function full_page_block_drop(B){var A=B.closest(".full_pagescroll");B.droppable({tolerance:"pointer",accept:".full_pagescroll,.cstlayer,.wp-new-tool-second-link,.wp-manage-plugin-block",drop:function(F,C){var D=$.ui.ddmanager.current;if($.getElementAreaInf($(D.element))==$.getElementAreaInf(A)){if(!A.hasClass("ui-modselected")||$(D.element).is(".wp-new-tool-second-link")||$(D.element).is(".wp-manage-plugin-block")){$(this).children(".li-placeholder").hide();var G=$(document).data("layer_final_drop_id");var E=$.chooseBiggerColumn(G,A.attr("id"));$(document).data("layer_final_drop_id",E)}}},over:function(I,M){var G=false;$(".ui-modselected").each(function(){if($(this).data("cstlayerstatus")=="unlock"){G=true}});if(G){return}var H=$.ui.ddmanager.current;if($.getElementAreaInf($(H.element))==$.getElementAreaInf(A)||$(H.element).is(".wp-new-tool-second-link")||$(H.element).is(".wp-manage-plugin-block")){if(!A.hasClass("ui-modselected")||$(H.element).is(".wp-new-tool-second-link")||$(H.element).is(".wp-manage-plugin-block")){var C=A.attr("id");var E=$(document).data("layer_drop_over_id");if(C!=E){var J=$.chooseBiggerColumn(E,C);if(J==C){var L=$(this);$(this).children(".li-placeholder").show();if(E){var F=$("#"+E);if(!F.is(".wp_droppable")){var D=F.children(".full_content").data("droppable")}else{var D=F.children(".drop_box").data("droppable")}D["isover"]=0;D["isout"]=1;D._out.call(D,I)}$(document).data("layer_drop_over_id",C)}else{var K=$(this).data("droppable");K["isover"]=0;K["isout"]=1}}}}},out:function(F,C){var G=false;$(".ui-modselected").each(function(){if($(this).data("cstlayerstatus")=="unlock"){G=true}});if(G){return}var D=$.ui.ddmanager.current;if($.getElementAreaInf($(D.element))==$.getElementAreaInf(A)){if(!A.hasClass("ui-modselected")||$(D.element).is(".wp-new-tool-second-link")||$(D.element).is(".wp-manage-plugin-block")){$(this).children(".li-placeholder").hide();var E=$(document).data("layer_drop_over_id");if(E==A.attr("id")){$(document).removeData("layer_drop_over_id")}}}}})}function fullpagescroll_propblk_init(){var B;for(var A in $.fullpagebackgroundPropDefaults){(function(){var F=A;var D=null;if($.inArray(F,["fullpage_moveto_prevop","fullpage_moveto_nextop"])!=-1){var C="",E="";switch(F){case"fullpage_moveto_prevop":E="top";C='<div class="wp-moveto_fstlevel"><a class="property-bar-top" href="###" title="'+translate("Move to top")+'"><span>&nbsp;</span></a></div>';break;case"fullpage_moveto_nextop":E="bottom";C='<div class="wp-moveto_lstlevel"><a class="property-bar-bottom" href="###" title="'+translate("Move to bottom")+'"><span>&nbsp;</span></a></div>';break}D={mousedown:function(){var I=$(this);var G=I.offset();var J=$("#scroll_container");var H=J.scrollTop();$(C).appendTo(J).css({top:function(){return(G.top+H-25-39)+"px"},left:G.left+"px"}).click(function(K){$("#"+$.bgselectedid).wp_setorder(E,$.bgselectedid);$(this).remove();I.removeClass("local");K.preventDefault()})},mouseup:function(){}}}$("#"+F).mousedown(function(G){var H=$(this);H.addClass("local");if($(".wp-moveto_fstlevel,.wp-moveto_lstlevel").size()){$(".wp-moveto_fstlevel,.wp-moveto_lstlevel").remove()}if(D!=null){D.mousedown.apply(this)}G.preventDefault()}).mouseup(function(G){var I=this,H=$(I);H.removeClass("local");$.fullpagebackgroundPropDefaults[F].apply(this);if(D!=null){D.mouseup.apply(this)}G.preventDefault()})})()}}(function(B){function A(C){var D={};D[C.prop("id")]="null";var F=C;while(true){var E=B.getElementFatherid(F);if(E=="none"){break}D[E]=F.prop("id");F=B("#"+E)}return D}B.chooseBiggerColumn=function(J,E){var L=E;if(J==E){return L}if(J){var K=B("#"+J);var F=B("#"+E);var N=A(K);var G=A(F);var M="canvas";if(!N[M]){M="site_footer"}var H=M;var I=M;while(H==I){H=N[H];I=G[I];if(H=="null"||I=="null"){break}}if(H=="null"){L=E}else{if(I=="null"){L=J}else{var D=B.parseInteger(B("#"+H).css("z-index"));var C=B.parseInteger(B("#"+I).css("z-index"));if(D>C){L=J}}}}return L};B.transferToColumn=function(C,E){var K=B.getElementFatherid(C);if(K!=E){var D=B("#"+E);var G=C.ab_pos("top");var F=D.ab_pos("top");var I=C.ab_pos("left");var J=D.ab_pos("left");var H=D;if(E!="canvas"){if(D.is(".wp_droppable")){H=D.children(".drop_box")}else{H=D.children(".full_content")}}C.detach().attr("fatherid",E).css({"top":(G-F),"left":(I-J)}).appendTo(H);if(E=="site_footer"||E=="canvas"){C.removeAttr("fatherid")}}};B.getElementAreaInf=function(C){return C.attr("inbuttom")=="1"?"site_footer":"canvas"};B.addFullPagescroll=function(D){if(B.wisplate){wp_alert(translate("fullpage.plate do not support add"));return false}if(B('.fullpage_alllist:not([deleted="deleted"])').length>0){wp_alert(translate("fullpage.already plugin"));return false}if(B('.cstlayer[type="mads"]:not([deleted="deleted"])').length>0){wp_alert(translate("Multi-filter and fullpage.already plugin"));return false}if(B('.full_column:not([deleted="deleted"])').length>0){wp_alert(translate("full_column.already Please remove"));return false}setTimeout(function(){if(B("#site_footer").length>0){var E="fullpage";if(B.wismobile){E="mfullpage"}if(confirm(translate("fullpage.Please hide site_footer"))){B.post(parseToURL(E,"prosf"),{pid:B.page_id},function(G){var F=B.parseJSON(G);if(F.result=="OK"){B("#site_footer").remove()}else{location.reload();return false}}).error(function(){location.reload();return false})}else{return false}}},500);var C=function(J,E){var F=J;if(E){var K=B(F).filter(".full_pagescroll");var M=K.prop("id");var L="layer"+fGuid();F=F.replace(new RegExp(M,"g"),L)}var G=B(F).appendTo("#canvas");G.find(".full_pagescroll").each(function(){fullpagescrollinit(B(this))});G.css("z-index",100);var H=relativeToAbsoluteURL("plugin/title/css/title.css");if(B("body").data("title")!=H){B("body").data("title",H);var O=document.getElementsByTagName("head").item(0);var I=document.createElement("link");I.href=H;I.rel="stylesheet";I.type="text/css";O.appendChild(I)}B(".ui-modselected").each(function(){B.hidWidgetBorder(B(this));if(B(this).hasClass("graphic_edited")){actived_graphic()}});B.fullpageunselectbgdiv(G);B.fullpageselectbgdiv(G.find(".full_pagescroll:eq(0)"));new AddCommand(G.prop("id")).insert();var N=new Array();N[0]=new Array(parseInt(B("#"+G.prop("id")).css("z-index")),G.prop("id"));B.zindexsort_new(N)};if(B.addFullPagescroll.html_cache){C(B.addFullPagescroll.html_cache,true);return}B.ajax({type:"GET",url:parseToURL("wp_widgets","gtfullpagescroll"),success:function(E){C(E,false)},error:function(F,E,G){wp_alert((G||E)+"(add a fullpagescroll).<br/>"+translate("Request failed!"));return false}})};B.curSelectableFather=function(){var C=B(".ui-modselected");if(C.length==0){B(document).data("cur_selectable_father",null);return null}else{var D=B.getElementFatherid(C.filter(":first"));B(document).data("cur_selectable_father",D);return D}};B.getElementFatherid=function(C){if(C.prop("id")=="canvas"||C.prop("id")=="site_footer"){return"none"}var D=C.attr("fatherid");if(!D||D==""){if(C.closest("#canvas").length>0){D="canvas"}else{if(C.closest("#site_footer").length>0){D="site_footer"}}}if(!B("#"+D).length){if(C.closest("#canvas").length>0){D="canvas"}else{if(C.closest("#site_footer").length>0){D="site_footer"}}C.removeAttr("fatherid")}return D};B.getFullColChildMaxButtomfullpage=function(C){var E=C.ab_pos_cnter("top");var D=E;C.find(".cstlayer,.full_pagescroll").each(function(){var F=B(this);var G=0;if(F.hasClass("cstlayer")){G=B.divrotate.getDegreeModMaxPoint(F,null,"buttom")}else{G=F.ab_pos_cnter("top")+B.parseInteger(F.css("height"))}if(D<G){D=G}});return D-E};B.getFullPagescrollButtomPos=function(C){if(C.hasClass("cstlayer")){return B.divrotate.getDegreeModMaxPoint(C,null,"buttom")}else{if(C.hasClass("full_pagescroll")){var D=0;C.find(".cstlayer,.full_pagescroll").andSelf().each(function(){var E=B(this);var F=0;if(E.hasClass("cstlayer")){F=B.divrotate.getDegreeModMaxPoint(E,null,"buttom")}else{F=E.ab_pos_cnter("top")+B.parseInteger(E.css("height"))}if(D<F){D=F}});return D}}};B.saveFullPagescrollObj=function(C){var D=C.height();var E={};if(C.prop("id")!="site_footer"){E={fullpageext:C.data("fullpageext"),top:B.parseInteger(C.css("top"))}}return B.extend({footerheight:D},E)};B.fullpagecanvasleft=function(){if(B(window).width()<=B("#canvas").width()){return"0"}else{return(B(window).width()-B("#canvas").width())/2}};B.wp_fullpagezoom=function(G,J,K,O){var F=G;var E=0,N=0,L=J.width,P=J.height;var C=F.find(".fullimgc");C.css("position","relative");var R=L-E,M=P-N;var H=L-K.width,D=P-K.height;var Q=0,I=0;if(H||(H>D)){C.width(R).height("auto");I=M-C.height();if(I<0){C.css({top:Math.ceil(I/2)+"px",left:"0px"})}else{if(I>0){C.height(M).width("auto");Q=R-C.width();C.css({top:"0px",left:Math.ceil(Q/2)+"px"})}else{C.css({top:"",left:"",position:""})}}}else{if(D||(H<D)){C.height(M).width("auto");Q=R-C.width();if(Q<0){C.css({top:"0px",left:Math.ceil(Q/2)+"px"})}else{if(Q>0){C.width(R).height("auto");I=M-C.height();C.css({top:Math.ceil(I/2)+"px",left:"0px"})}else{C.css({top:"",left:"",position:""})}}}}};B.wp_fullpag_mobile=function(){return(/iphone|ipod|ipad|Macintosh|android|Windows phone/i.test(navigator.userAgent.toLowerCase()))};setTimeout(function(){if(B.wismobile&&B.wisviewmode){}else{var C={width:320,height:B(window).height()};if(!B.wiseditmode){C={width:B(window).width(),height:B(window).height()};var F=B(".fullpage_alllist");var D=F.find(".section.active .bg > img");var E={width:0,height:0};B.wp_fullpagezoom(F,C,E,"noresize")}}},800)})(jQuery);